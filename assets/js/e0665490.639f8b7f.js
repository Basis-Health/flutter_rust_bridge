"use strict";(self.webpackChunkflutter_rust_bridge=self.webpackChunkflutter_rust_bridge||[]).push([[7287],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var u=n.createContext({}),s=function(e){var t=n.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=s(e.components);return n.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,u=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(r),m=a,f=d["".concat(u,".").concat(m)]||d[m]||c[m]||i;return r?n.createElement(f,o(o({ref:t},p),{},{components:r})):n.createElement(f,o({ref:t},p))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=d;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=r[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2292:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var n=r(7462),a=(r(7294),r(3905));const i={},o="Upgrade to V2",l={unversionedId:"guides/miscellaneous/upgrade",id:"guides/miscellaneous/upgrade",title:"Upgrade to V2",description:"This guide shows how to upgrade a project using flutterrustbridge V1 to V2.",source:"@site/docs/guides/miscellaneous/upgrade.md",sourceDirName:"guides/miscellaneous",slug:"/guides/miscellaneous/upgrade",permalink:"/flutter_rust_bridge/guides/miscellaneous/upgrade",draft:!1,editUrl:"https://github.com/fzyzcjy/flutter_rust_bridge/tree/master/website/docs/guides/miscellaneous/upgrade.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"What's new in V2",permalink:"/flutter_rust_bridge/guides/miscellaneous/whats-new"},next:{title:"How-to",permalink:"/flutter_rust_bridge/guides/how-to/"}},u={},s=[],p={toc:s};function c(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"upgrade-to-v2"},"Upgrade to V2"),(0,a.kt)("p",null,"This guide shows how to upgrade a project using flutter_rust_bridge V1 to V2."),(0,a.kt)("p",null,"One way is as follows:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Follow the ",(0,a.kt)("a",{parentName:"li",href:"../../quickstart"},"quickstart")," to integrate V2 boilerplate into the existing project (in a few commands)."),(0,a.kt)("li",{parentName:"ul"},"Move original Rust code to ",(0,a.kt)("inlineCode",{parentName:"li"},"rust/src/api/simple.rs"),"."),(0,a.kt)("li",{parentName:"ul"},"Run code generator (whenever your code changes)."),(0,a.kt)("li",{parentName:"ul"},"Fix compilation errors (usually just a rename or relocation) and runtime exceptions (usually have hints).")),(0,a.kt)("p",null,"Some changes and quick fixes (renames) are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"SyncReturn")," type becomes annotation: Change ",(0,a.kt)("inlineCode",{parentName:"li"},"fn f() -> SyncReturn<T> {}")," to ",(0,a.kt)("inlineCode",{parentName:"li"},"#[frb(sync)] fn f() -> T {}")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"api.functionName()")," -> ",(0,a.kt)("inlineCode",{parentName:"li"},"functionName()")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"DartAbi")," -> ",(0,a.kt)("inlineCode",{parentName:"li"},"DartDynamic")," (simple name alias)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ZeroCopyBuffer<T>")," -> ",(0,a.kt)("inlineCode",{parentName:"li"},"T")," (just remove the wrapper, it is automatically zero-copy by default)"),(0,a.kt)("li",{parentName:"ul"},"Initialize the system via ",(0,a.kt)("inlineCode",{parentName:"li"},"RustLib.init()")," when starting app."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"flutter_rust_bridge_codegen")," -> ",(0,a.kt)("inlineCode",{parentName:"li"},"flutter_rust_bridge_codegen generate")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"flutter_rust_bridge_serve")," -> ",(0,a.kt)("inlineCode",{parentName:"li"},"flutter_rust_bridge_codegen build-web")," + standard ",(0,a.kt)("inlineCode",{parentName:"li"},"flutter run")," (or run in IDE)")),(0,a.kt)("p",null,"Surely, there are alternative approaches.\nFor example, if you want to keep the compilation and integration between Rust and Dart,\nor like to use command line arguments,\njust find the corresponding counterparts in V2 and rename things."),(0,a.kt)("p",null,"Some flags are removed,\nwhen, for example, they exist mainly for compatibility of later V1 with earlier V1 versions.\nIf you find the removed flag important for your scenario, feel free to create an issue."))}c.isMDXComponent=!0}}]);